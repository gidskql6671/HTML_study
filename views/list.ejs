<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<title>Study Web Server</title>
	</head>
	<body>
		<div> 
			<h2>
				DB list
			</h2>
			
			<button onclick="history.back()">Back</button>
			<ul>
				
			<% for(let i = 0; i < posts.length; i++){ %>
				<li> 
					<p> Title: <%= posts[i].title %> </p>
					<p> created : <%= moment(posts[i].created).format('YYYY-MM-DD hh:mm') %> </p>
					<p> id : <%= posts[i]._id %> </p>
					<div style="width: 400px; border: 2px solid black; border-radius: 2px; padding: 10px;">
						<p> <%= posts[i].content %> </p>
					</div>
					<button class="btn-delete-post" data-id="<%= posts[i]._id %>"> 글 삭제 </button> </li>
			<% } %>
				
			</ul>
			
		</div>
		
		<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
		
		<script>
			
			$('.btn-delete-post').click((e) => {
				let postId = e.target.dataset.id;
				
				$.ajax({
					method: 'DELETE',
					url: '/post/delete',
					data: {id: postId}
				}).done((result) => {
					$(e.currentTarget).parent('li').fadeOut();
				});
			});
		</script>
	</body>
</html>